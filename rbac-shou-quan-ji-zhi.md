---
description: 授權機制
---

# RBAC授權機制

## 架構

以Role Based Accecc Control機制延生設計以下系統授權機制

<figure><img src=".gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

說明

* 多租戶架構，跨租戶間數據不流通，不共享
* 當用戶有跨租戶管理需求，則需切換不同帳號
* 以下以單一租戶說明



{% tabs %}
{% tab title="User 用戶" %}
* 用戶增加用戶組織樹狀結構
* 第一層組織：
  * 主管機關(縣市政府)
  * 客運業者(三地集團、首都集團、新營客運、員林客運、金牌客運、普悠瑪客運)
  * 製造商(鴻華)
  * 平台開發商(鴻海)
* 第二層組織：
  * 主管機關(縣市政府) > 各局處
    * 交通局、環保局等。
  * 客運業者：
    * 三地集團>高雄客運、府城客運。
    * 首都集團>台中客運、三重客運、台北客運、大都會客運。
    * 新營客運、員林客運、金牌客運、普悠瑪客運 暫無第二層組織。
    * 製造商(鴻華) 暫無第二層組織，可隨需定義。
    * 平台開發商(鴻海) 暫無第二層組織，可隨需定義。
* 組織圖



* 一位用戶只屬於一個組織
* 一位用戶可能同時屬於組織內多個部門
* 討論
  * 當用戶組織階層多時，可支援用戶組綁角色。不多時，用戶直接綁角色比較有彈性。
{% endtab %}

{% tab title="Role 角色" %}
* 角色分為 **共用角色** 與 **特殊角色。**
  * **共用角色**為所有組織共用，**特殊角色**為單一組織使用。
  * **共用角色**只有超級管理員(共)可新/刪/改，其餘角色僅可查詢。
  * **特殊角色**區分組織，與第一層用戶組織連動(主管機關、客運業者\*N、製造商、平台開發商)
* 超級管理員(共)可檢視所有角色，及所有操作權限。
* 其餘角色僅能檢視共用角色+組織自行定義的特殊角色。
* 情境說明
  * 目前有3個共用角色：超級管理員(共)、系統維運人員(共)、報表分析人員(共)。
  * 三地集團-高雄客運自行定義2個特殊角色：鳳山站長(特)、楠梓站長(特)。
  * 普悠瑪客運自行定義2個特殊角色：總站長(特)、營運分析人員(特)。
  * 製造商自行定義2個特殊角色：維修人員(特)、駐點客戶人員(特)。
  * 主管機關/平台開發商 進入系統可以看到3個共用角色(僅可查詢)
  * 製造商進入系統可以看到3個共用角色(僅可查詢)+2個自定義特殊角色(所有操作權限)
  * 三地集團-高雄客運進入系統可以看到3個共用角色(僅可查詢)+2個自定義特殊角色(所有操作權限)



* 討論
  * 考量是否下放角色管理功能，是否由超級管理員統一管理角色
  * 暫時不考慮role分層(RBAC1)，若存在user階層關係，直接用不同role賦予權限上的階級差異即可
{% endtab %}

{% tab title="Permissions 操作權限" %}
* 操作權限設定以功能目錄樹狀結構表示
* 每個功能(Resource)下支援操作(Operation)權限設定:增/刪/改/查等基本操作權限，保留可加入客製操作權限之彈性。e.g. 下載權限
* 作用於目錄內功能及按鈕顯示及訪問/操作權限
{% endtab %}

{% tab title="Scopes 資料範圍" %}
* 資料範圍用於設定角色可存取的資料範圍。
* 設定以**客運業者**(第一階)>**場站**(第二階)樹狀結構表示
* 依照登入用戶的第一層組織連動可選擇的資料範圍
  * 若組織 in (主管單位、製造商、平台開發商)皆**可存取全部資料 或 設定子集合**。
  * 若組織=客運業者，則限制資料範圍僅能選擇該業者資料
    * 單獨客運業者**僅可以存取自己的資料，無法更改設定**。
    * 集團式客運業者**可存取集團內客運業者資料  或 設定子集合。**
* 套用於部分報表及功能作為資料權限區分
  * e.g. 場站營運報表，若為普悠瑪客運，僅能查看普悠瑪客運底下各場站數據
* 考慮部分部分報表及功能可能無法套用



* 討論
  * 考量不同維度設定資料範圍的需求
  * 由於目前組織可存取資料範圍較單純，且變動不高，可考量直接以系統config方式來做
{% endtab %}
{% endtabs %}





## 系統功能



<details>

<summary>組織管理</summary>



</details>

<details>

<summary>帳號管理</summary>



</details>

<details>

<summary>角色管理</summary>



</details>

<details>

<summary>角色權限管理</summary>



</details>

